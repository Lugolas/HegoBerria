<?php

namespace sitebde\ParrainageBundle\Repository;

/**
 * EtudiantRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class EtudiantRepository extends \Doctrine\ORM\EntityRepository
{
    // Retourne l'étudiant, ses loisirs et ses 
    public function getEtudiantLoisirsEtSports($idEtudiant)
    {
        // Récupérer le gestionnaire d'entités
        $gestionnaireEntite = $this->_em;
        
        // Ecriture de la requête personnalisée
        $requetePerso = $gestionnaireEntite->createQuery('SELECT e, l, el, s, es, emft, mft, emfb, mfb
                                                          FROM sitebdeParrainageBundle:Etudiant e
                                                          LEFT JOIN e.etudiantLoisirs el
                                                          LEFT JOIN el.loisir l
                                                          LEFT JOIN e.etudiantSports es
                                                          LEFT JOIN es.sport s
                                                          LEFT JOIN e.etudiantMatiereFortes emft
                                                          LEFT JOIN emft.matiere mft
                                                          LEFT JOIN e.etudiantMatiereFaibles emfb
                                                          LEFT JOIN emfb.matiere mfb
                                                          WHERE e.id = :id
                                                          ORDER BY l.categorie, s.categorie, mft.categorie, mfb.categorie');
        
        $requetePerso->setParameter('id', $idEtudiant);
        
        // Retourner les résultats de l'exécution de la requête
        return $requetePerso->getResult();
    }
}
